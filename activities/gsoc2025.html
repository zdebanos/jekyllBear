<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>GSoC 2025 Project | Personal page of Steve (zdebanos)</title><meta name="description" content="Student at FEE CTU"><link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/favicon.ico" type="image/x-icon"><link href='/feed.xml' rel='alternate' type='application/atom+xml'><link rel="canonical" href="/activities/gsoc2025"><link rel="stylesheet" href="/assets/style.css"><body><main><h2 class="title">Personal page of Steve (zdebanos)</h2><nav> <a href="http://zdebanos.cz">Home</a> <a href="http://zdebanos.cz/activities.html">Activities</a> <a href="http://zdebanos.cz/contact.html">Contact</a> <a href="http://zdebanos.cz/teaching/root.html">Teaching</a></nav><article><h1>GSoC 2025 Project</h1><p>Tl;dr for the GSoC evaluators - the proof of my work can be found here in these pull requests:</p><ul><li><a href="https://github.com/silicon-heaven/shv-libs4c/pull/11">SHV Library</a><li><a href="https://github.com/apache/nuttx-apps/pull/3170">Integration of the SHV library into NuttX</a><li><a href="https://github.com/robertobucher/pysimCoder/pull/118">Integration of the SHV library into pysimCoder, NXBoot updates</a></ul><p>As of 1st of September, I still need to address issues in the pull requests.</p><h2 id="overview">Overview</h2><p>The project I’ve participated in was called Firmware Upgrades over Silicon-Heaven Protocol for NXboot Demonstrated on pysimCoder. Looking at the title, one may become lost in all the names used in the title. Let’s start slowly describing each part of my project!</p><h3 id="silicon-heaven-framework-shv">Silicon Heaven framework (SHV)</h3><p>A framework with open-source protocol specification and implementation in many programming languages. Developed and maintained by people from Elektroline, a.s., a Czech company. The protocol specification can be found <a href="https://silicon-heaven.github.io/shv-doc/index.html">here</a>.</p><p>The protocol is used as a remote procedure call (RPC) system with custom serialization packing schema (data serialization). The fundamental structure in SHV is the communication tree comprised of nodes. Each node has a set of methods, which are essentially just callbacks into my application. In application, you can use the API to register your own functions as callbacks.</p><p>The SHV infrastructure requires a broker to handle all connected devices (like in MQTT). This serves as a concentrator of all connected devices.</p><p>While Elektroline, a.s. has its own implementation in the C language, my goal was to take the implementation already present in pysimCoder (more on that later), developed by Michal Lenc, refine it, add file node implementation and make a library out of it. The advantage of my library lies in its simplicity - the whole communication with the outer world just depends on two buffers - RX and TX, making it feasible for memory constrained devices.</p><p>The only requirement to run this library is have an environment where launching a communication thread is possible.</p><p>My new implementation is now located <a href="https://github.com/silicon-heaven/shv-libs4c">here</a> and supports POSIX out of the box, with tweaks to make it work on Linux and NuttX. Adaptation to any other RTOS (Zephyr, RTEMS, ThreadX) or Windows using Win32 API is possible.</p><h3 id="nuttx-and-nxboot">NuttX and NXBoot</h3><p>Apache NuttX is a real-time operating system (RTOS) with an emphasis on standards compliance and small footprint. Scalable from 8-bit to 64-bit microcontroller environments, the primary governing standards in NuttX are POSIX and ANSI standards (cited from <a href="https://github.com/apache/nuttx">here</a>).</p><p>NXBoot is a bootloader developed by Michal Lenc as a replacement for MCUBoot. NuttX features support for MCUBoot, however, Elektroline developers quickly found out the scratchpad mechanism is a deadly killer for the external flash. Since they couldn’t get this fetaure into the MCUBoot’s mainline, they decided to implement this mechanism as a standalone bootloader into NuttX.</p><p>NXBoot utilizes three image partitions: primary, secondary and tertiary. The primary partition is usually the MCU’s flash whereas secondary and tertiary partitions, used as update and recovery partitions, are located usually on an external flash.</p><p>NXBoot provides API for interacting with the update partition. Each time new image is copied from the update partition into the primary partition and started, the image must be then confirmed, otherwise the primary partition is reflashed by the recovery image.</p><p>The goal of a firmware update tool is to interact with the update parititon, check the checksum, reset the device and then confirm the image, if the image booted up correctly. More on the algorithm can be read <a href="https://nuttx.apache.org/docs/latest/applications/boot/nxboot/index.html">here</a>.</p><h3 id="pysimcoder">pysimCoder</h3><p>pysimCoder is a rapid control prototyping tool developed by professor Roberto Bucher from SUPSI. In this project, we use it as a code generator for control applications. We consider this as an open-source alternative to Matlab/Simulink.</p><p>The tool supports code generation for NuttX, allowing to run control applications directly on embedded devices running NuttX. To allow the tuning of the quickly prototyped model, each block’s parameters feature a getter and setter, allowing to change model’s parameters, such as signal references or PID controller’s parameters.</p><p>If turned on, the code generator can map each block to a SHV node, construct a SHV tree and use these getters and setters as nodes’ methods. This allows for remote tuning of the model’s parameters over TCP/IP, for example.</p><h2 id="the-project-goals">The project goals</h2><h2 id="the-steps-ive-undergone">The steps I’ve undergone</h2><p>Here, I’ll explain all the steps I’ve done to finish my GSoC 2025 project.</p><h3 id="shv-libs4c">shv-libs4c</h3><h3 id="nuttx-integration">NuttX integration</h3><h3 id="pysimcoder-integration">pysimCoder integration</h3></article></main><footer class="bottom-footer"> <!-- <span class="mini-note">You've reached the end of the page. Good job!</span> --> <!--<nav class="sans"><hr><p><label class="menu-icon" for="menu-btn">Menu</label></p><ul class="site-nav"><li><a href="/">Home</a><li><a href="/blog">Blog</a><li><a href="/designs">Designs</a><li><a href="/about">About</a><li><a href="https://canisee.xyz" title="Confirm your vision functionality">[Can I See]</a></ul></nav>--> <i>Theme <a href="https://knhash.in/jekyllBear" title="the art">jekyllBear</a> built and maintained by <a href="https://knhash.in" title="the artist">knhash</a> </i></footer>
